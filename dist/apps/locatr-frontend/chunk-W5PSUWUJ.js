import{$ as p,Fa as f,L as C,Na as l,R as g,W as D,Z as b,_ as I,a as v,b as y,d as n,ha as x,ia as S,ja as k,lb as z,ob as F,p as M,t as u,ta as m,u as s}from"./chunk-GHWY76KD.js";var L=(()=>{let e=class e{constructor(){this.map=null,this.apiKey="AIzaSyBC_xFYzPzcK2zQoVAvwk93X1lNFzXuU_U",this.defaultMapOptions={center:{lat:-28.4793,lng:24.6727},zoom:6},this.initializeLoader()}initializeLoader(){this.loader=new z({apiKey:this.apiKey,version:"beta",libraries:["places","marker"]})}loadMap(a,t){return n(this,null,function*(){let{Map:i}=yield this.loader.importLibrary("maps");this.map=new i(a,y(v({},this.defaultMapOptions),{mapId:t}))})}createMarker(a,t){return n(this,null,function*(){let{AdvancedMarkerElement:i,PinElement:r}=t,Q=a.position,R=new r({scale:.875}),d=new i({position:Q,map:this.map,content:R.element,title:a.name,gmpClickable:!0,collisionBehavior:google.maps.CollisionBehavior.REQUIRED});d.addListener("click",({domEvent:B})=>{let{target:j}=B,h=new google.maps.InfoWindow;h.close(),h.setContent(d.title),h.open(d.map,d)})})}loadMapData(a){return n(this,null,function*(){if(this.map&&a.length>0){let t=yield google.maps.importLibrary("marker"),i=new google.maps.LatLngBounds;for(let r of a)yield this.createMarker(r,t),i.extend(r.position);this.map.fitBounds(i)}})}};e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=M({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();var P=["mapContainer"],E=(()=>{let e=class e{set routeData(a){this.mapData=a,this.loadMapData()}constructor(){this.mapId="route-map",this.mapService=u(L),this.mapData=[],this.mapInitialized=!1,f(()=>n(this,null,function*(){yield this.loadMap()}))}loadMap(){return n(this,null,function*(){if(this.mapContainer&&this.mapId){let a=this.mapContainer.nativeElement;yield this.mapService.loadMap(a,this.mapId),this.mapInitialized=!0,this.loadMapData()}})}loadMapData(){return n(this,null,function*(){this.mapInitialized&&this.mapData.length>0&&(yield this.mapService.loadMapData(this.mapData))})}};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s({type:e,selectors:[["lib-google-map"]],viewQuery:function(t,i){if(t&1&&x(P,7),t&2){let r;S(r=k())&&(i.mapContainer=r.first)}},inputs:{mapId:"mapId",routeData:"routeData"},standalone:!0,features:[m],decls:2,vars:0,consts:[["mapContainer",""],["id","map",1,"map-container"]],template:function(t,i){t&1&&p(0,"div",1,0)},dependencies:[l],styles:[".map-container[_ngcontent-%COMP%]{height:100%;width:100%;border-radius:.375rem;border-width:1px;padding:.25rem;--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}"]});let o=e;return o})();var O=(()=>{let e=class e{constructor(){this.mapId="route-map",this.routes=g([]),this.routeData=g([]),this.routeService=u(F),f(()=>{let a=this.routeData().map(t=>{if(t.order.client?.site)return{position:{lat:+t.order.client?.site.latitude,lng:+t.order.client?.site.longitude},address:t.order.client?.site.address,name:t.order.client?.name}}).filter(t=>t?.position.lat&&t?.position.lng);this.routes.set(a)},{allowSignalWrites:!0})}ngOnInit(){return n(this,null,function*(){let a=yield this.routeService.getAll();this.routeData.set(a)})}};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s({type:e,selectors:[["lib-route-map"]],standalone:!0,features:[m],decls:2,vars:2,consts:[[1,"route-map-container"],[3,"id","routeData"]],template:function(t,i){t&1&&(b(0,"div",0),p(1,"lib-google-map",1),I()),t&2&&(C(),D("id",i.mapId)("routeData",i.routes()))},dependencies:[l,E],styles:["[_nghost-%COMP%]{display:block;height:100%}.route-map-container[_ngcontent-%COMP%]{height:100%}"]});let o=e;return o})();var ct=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s({type:e,selectors:[["lib-route-optimisation"]],standalone:!0,features:[m],decls:1,vars:0,template:function(t,i){t&1&&p(0,"lib-route-map")},dependencies:[l,O]});let o=e;return o})();export{ct as RouteOptimisationComponent};
